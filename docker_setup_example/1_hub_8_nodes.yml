version: '3.9'

services:

  hub:
    image: minidb_1.0
    container_name: hub
    networks: 
      - default
    environment:
        CONN_CONF: "node1 8081 node2 8082 node3 8083 node4 8084 node5 8085 node6 8086 node7 8087 node8 8088"
    command: "tail -f /dev/null"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

  node1:
    image: minidb_1.0
    container_name: node1
    networks: 
      - default
    environment:
        NODE1_IP: "8081"
    command: "./setup_scripts/init_node1.sh"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

  node2:
    image: minidb_1.0
    container_name: node2
    networks: 
      - default
    environment:
        NODE2_IP: "8082"
    command: "./setup_scripts/init_node2.sh"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

  node3:
    image: minidb_1.0
    container_name: node3
    networks: 
      - default
    environment:
        NODE3_IP: "8083"
    command: "./setup_scripts/init_node3.sh"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

  node4:
    image: minidb_1.0
    container_name: node4
    networks: 
      - default
    environment:
        NODE4_IP: "8084"
    command: "./setup_scripts/init_node4.sh"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

  node5:
    image: minidb_1.0
    container_name: node5
    networks: 
      - default
    environment:
        NODE5_IP: "8085"
    command: "./setup_scripts/init_node5.sh"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

  node6:
    image: minidb_1.0
    container_name: node6
    networks: 
      - default
    environment:
        NODE6_IP: "8086"
    command: "./setup_scripts/init_node6.sh"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

  node7:
    image: minidb_1.0
    container_name: node7
    networks: 
      - default
    environment:
        NODE7_IP: "8087"
    command: "./setup_scripts/init_node7.sh"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

  node8:
    image: minidb_1.0
    container_name: node8
    networks: 
      - default
    environment:
        NODE8_IP: "8088"
    command: "./setup_scripts/init_node8.sh"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

